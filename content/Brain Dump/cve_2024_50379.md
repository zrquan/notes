---
title: "CVE-2024-50379"
author: ["4shen0ne"]
tags: ["cve"]
draft: false
---

> [!info] NVD Desc
> Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability during JSP compilation in Apache Tomcat permits an RCE on case insensitive file systems when the default servlet is enabled for write (non-default configuration). This issue affects Apache Tomcat: from 11.0.0-M1 through 11.0.1, from 10.1.0-M1 through 10.1.33, from 9.0.0.M1 through 9.0.97. Users are recommended to upgrade to version 11.0.2, 10.1.34 or 9.0.98, which fixes the issue.

Tomcat RCE æ¼æ´ï¼Œè¯„åˆ† 9.8

å½±å“èŒƒå›´ï¼š

-   9.0.0.M1 â‰¤ Apache Tomcat &lt; 9.0.98
-   10.1.0-M1 â‰¤ Apache Tomcat &lt; 10.1.34
-   11.0.0-M1 â‰¤ Apache Tomcat &lt; 11.0.2

åˆ©ç”¨æ¡ä»¶ï¼š

1.  Tomcat é…ç½®ä¸­çš„ readonly å‚æ•°ä¸º falseï¼ˆå¯å†™ï¼‰
2.  å…è®¸ä½¿ç”¨ PUT æ–¹æ³•ï¼ˆå¯ä¸Šä¼ æ–‡ä»¶ï¼‰
3.  ç³»ç»Ÿä¸º Windowsï¼ˆå¤§å°å†™ä¸æ•æ„Ÿï¼‰

è¿™ä¸ªæ´è¯´æ˜¯ä»»æ„å‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯æ€ä¹ˆæ„Ÿè§‰ä¸å¤ªå¯¹åŠ²ã€‚ã€‚ã€‚å¦‚æœæˆ‘æ²¡ç†è§£é”™ï¼Œæ¼æ´æœ¬è´¨ä¸Šæ˜¯åˆ©ç”¨ Windows çš„å¤§å°å†™ä¸æ•æ„Ÿç‰¹æ€§è¿›è¡Œæ–‡ä»¶è¦†ç›–ï¼Œæ¯”å¦‚ä¸Šä¼  TEST.jsp ä¼šè¦†ç›–ç›¸åŒè·¯å¾„ä¸‹çš„
test.jspï¼Œè€Œåœ¨ Linux ä¸Šä¼šè§†ä¸ºä¸¤ä¸ªæ–‡ä»¶

è¦è¯´æ˜¯æ–‡ä»¶è¦†ç›–æ¼æ´å€’èƒ½ç†è§£ï¼Œä½†è¯´æ˜¯ RCEï¼Œæˆ‘æ—¢ç„¶èƒ½ä¸Šä¼  jsp äº†ï¼Œè¦†ä¸è¦†ç›–æœ‰å•¥åŒºåˆ«å‘¢ğŸ¤”
å¯èƒ½ç‰¹å®šåœºæ™¯ä¸‹å¯ä»¥ç»•è¿‡ä¸€äº›æ£€æµ‹è§„åˆ™ï¼Ÿ
